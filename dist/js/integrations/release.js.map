{"version":3,"file":"release.js","sourceRoot":"","sources":["../../../src/js/integrations/release.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,uBAAuB,EAAE,aAAa,EAAE,MAAM,cAAc,CAAC;AAGtE,OAAO,EAAE,MAAM,EAAE,MAAM,YAAY,CAAC;AAEpC,iEAAiE;AACjE;IAAA,MAAa,OAAO;QAApB;YACE;;eAEG;YACI,SAAI,GAAW,OAAO,CAAC,EAAE,CAAC;QAqCnC,CAAC;QA/BC;;WAEG;QACI,SAAS;YACd,uBAAuB,CAAC,CAAO,KAAY,EAAE,EAAE;gBAC7C,MAAM,IAAI,GAAG,aAAa,EAAE,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;gBACrD,IAAI,CAAC,IAAI,EAAE;oBACT,OAAO,KAAK,CAAC;iBACd;gBAED,IAAI;oBACF,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,YAAY,EAAE,CAAC;oBAC5C,IAAI,OAAO,EAAE;wBACX,KAAK,CAAC,OAAO,GAAG,GAAG,OAAO,CAAC,EAAE,IAAI,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,KAAK,EAAE,CAAC;wBACpE,KAAK,CAAC,IAAI,GAAG,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;qBACjC;iBACF;gBAAC,OAAO,GAAG,EAAE;oBACZ,yCAAyC;iBAC1C;gBAED,qFAAqF;gBACrF,IAAI,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,gBAAgB,EAAE;oBAC/C,KAAK,CAAC,OAAO,GAAG,GAAG,KAAK,CAAC,KAAK,CAAC,gBAAgB,EAAE,CAAC;iBACnD;gBACD,IAAI,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,aAAa,EAAE;oBAC5C,KAAK,CAAC,IAAI,GAAG,GAAG,KAAK,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;iBAC7C;gBAED,OAAO,KAAK,CAAC;YACf,CAAC,CAAA,CAAC,CAAC;QACL,CAAC;;IAnCD;;OAEG;IACW,UAAE,GAAW,SAAS,CAAC;IAiCvC,cAAC;KAAA;SAzCY,OAAO","sourcesContent":["import { addGlobalEventProcessor, getCurrentHub } from \"@sentry/core\";\nimport { Event, Integration } from \"@sentry/types\";\n\nimport { NATIVE } from \"../wrapper\";\n\n/** Release integration responsible to load release from file. */\nexport class Release implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public name: string = Release.id;\n  /**\n   * @inheritDoc\n   */\n  public static id: string = \"Release\";\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    addGlobalEventProcessor(async (event: Event) => {\n      const self = getCurrentHub().getIntegration(Release);\n      if (!self) {\n        return event;\n      }\n\n      try {\n        const release = await NATIVE.fetchRelease();\n        if (release) {\n          event.release = `${release.id}@${release.version}+${release.build}`;\n          event.dist = `${release.build}`;\n        }\n      } catch (_Oo) {\n        // Something went wrong, we just continue\n      }\n\n      // If __sentry_release or __sentry_dist it should be stronger because the user set it\n      if (event.extra && event.extra.__sentry_release) {\n        event.release = `${event.extra.__sentry_release}`;\n      }\n      if (event.extra && event.extra.__sentry_dist) {\n        event.dist = `${event.extra.__sentry_dist}`;\n      }\n\n      return event;\n    });\n  }\n}\n"]}